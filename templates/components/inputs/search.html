{% load i18n %}

<c-vars
theme="input select-none peer ltr:!pl-12 rtl:!pr-12"
/>

<div 
id="search-container" 
class="relative" 
x-data="{ open: false }"
@click.outside="open = false">

    <div class="relative">

        {% if name is None %}
            <input
            hx-post="{{ path }}"
            hx-trigger="input changed delay:500ms, search"
            hx-swap="innerHTML"
            hx-target="#search-results"
            hx-indicator="#search-spinner"
            @keydown="open = true"
            type="text"
            class="{{ theme }}"
            id="search-input"
            name="q"
            placeholder="{{ placeholder }}">
        {% else %}

            <input 
            type="text"
            class="{{ theme }} select-none"
            aria-disabled="true"
            value="{{ id }}"
            tabindex="-1"
            name="{{ name }}">

            <div class="absolute left-0 top-0 w-full h-full dark:bg-gray-900 bg-white border dark:border-gray-800 border-gray-100 rounded-md py-2 px-12">
                {{ obj.name }}
            </div>

        {% endif %}

        <span class="absolute ltr:left-12 rtl:right-12 top-1/2 -translate-y-1/2 hidden peer-aria-disabled:block" data-mask>
        </span>

        <span
        hx-get="{{ path }}"
        hx-target="#search-container"
        hx-indicator="#no-content"
        hx-swap="outerHTML"
        hx-trigger="click"
        class="absolute cursor-pointer rtl:left-4 ltr:right-4 top-1/2 -translate-y-1/2 z-20 hidden peer-aria-disabled:block">
            <c-btns.icon>
                <c-icons.x ratio="1.25rem"></c-icons.x>
            </c-btns.icon>
        </span>

        <div 
        id="search-spinner"
        class="block absolute rtl:right-4 ltr:left-4 top-1/2 -translate-y-1/2 hx-request:animate-slow-pulse">
            <c-icons.magnifier ratio="1.25rem"></c-icons.magnifier>
        </div>

    </div>

    <ul x-show="open" x-collapse.duration.150ms id="search-results" class="absolute left-0 top-[calc(100%_+_0.5rem)] w-full bg-white dark:bg-gray-950 divide-y divide-gray-200 dark:divide-gray-900 rounded-lg ring-1 ring-gray-100 dark:ring-gray-900 shadow-md dark:shadow-inner max-h-48 overflow-y-auto empty:hidden"></ul>

</div>