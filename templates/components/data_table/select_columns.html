{% load i18n %}

<div
  class="relative w-fit"
  x-init="canOpen = Boolean(headers.length)"
  x-data="{
  canOpen: true,
  dropdownOpen: false, 
}"
>
  <span
    @click="dropdownOpen = canOpen"
    :class="{'!border-blue-500 !outline-none': dropdownOpen}"
    class="flex items-center justify-center gap-2 rounded-md border border-neutral-200 px-4 py-2 text-sm font-medium transition-colors focus:outline-none disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-800"
    role="button"
  >
    <span
      x-text="selectedColumns ?  selectedColumns + '{% translate ' selected' %}' : '{% translate 'columns' %}'"
      class="translate-y-px capitalize leading-none"
    ></span>
    <span>
      <c-icons.columns ratio="1rem" />
    </span>
  </span>

  <div
    x-show="dropdownOpen"
    @click.away="dropdownOpen=false"
    x-transition:enter="ease-out duration-200"
    x-transition:enter-start="-translate-y-2"
    x-transition:enter-end="translate-y-0"
    class="absolute end-2 top-0 z-50 mt-8 min-w-56"
    x-cloak
  >
    <div
      class="mt-1 rounded-md border border-neutral-200 bg-white p-1 shadow-md dark:border-neutral-800 dark:bg-neutral-800"
    >
      <template x-for="(header, idx) in headers" :key="header[0]">
        <div
          class="relative flex cursor-pointer select-none items-center gap-2 rounded px-2 py-1.5 text-sm outline-none transition-colors hover:bg-neutral-100 dark:hover:bg-neutral-900"
          x-data="{ id: $id('select-column')}"
        >
          <input :id="id" type="checkbox" class="check" x-model="header[2]" />
          <label
            :for="id"
            x-text="header[1].name"
            class="block whitespace-nowrap first-letter:capitalize"
          >
          </label>
        </div>
      </template>
    </div>
  </div>
</div>
