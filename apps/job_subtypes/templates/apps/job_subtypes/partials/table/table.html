{% load i18n %}

<form 
hx-get="{{ bulk_path }}" 
hx-include="[data-include]"
x-data="{ selectedRows: [] }">

  <c-table.container>

    <input
    data-include
    type="hidden"
    name="order"
    value="{% firstof request.GET.order default_column %}"/>
  
    <c-table.table>
      
      <thead>

        <c-table.header-row>
          <th class="px-2 py-1">
            {% if can_delete %}
            <c-table.check data_check="all" />
            {% endif %}
          </th>
          <th>
            <c-table.header-cell 
            hx-get="{{ index_path }}"
            hx-target="{{ target }}"
            code_name="name"
            name="{% translate 'name' %}" />
          </th>
          <th>
            <c-table.header-cell 
            hx-get="{{ index_path }}"
            hx-target="{{ target }}"
            code_name="job_type"
            name="{% translate 'job type' %}" />
          </th>
          <th>
            <c-table.header-cell 
            hx-get="{{ index_path }}"
            hx-target="{{ target }}"
            code_name="description"
            name="{% translate 'description' %}" />
          </th>
          <th></th>
        </c-table.header-row>

        {% if can_delete %}
        <c-table.unselect-all colspan="4">
          {% if can_delete %}
            <c-table.action-input
              name="bulk_delete"
              value="{% translate 'delete'|title %}"
              title="{% translate 'delete'|title %}" />
          {% endif %}
          {% if user.is_superuser %}
            <c-table.action-input
              name="bulk_reslugify"
              value="{% translate 'reslugify'|title %}"
              title="{% translate 'reslugify'|title %}" />
          {% endif %}
        </c-table.unselect-all>
        {% endif %}

      </thead>
      <!-- end header -->
  
      <!-- start rows -->
      <c-table.tbody>
        {% for obj in qs %}
        <c-table.tr>
          <td class="p-2"><c-table.check /></td>

          {% if can_update %}
          <c-table.td href="{{ obj.get_update_path }}">
            {{ obj.name }}
          </c-table.td>
          {% else %}
          <c-table.td>{{ obj.name }}</c-table.td>
          {% endif %}

          {% if perms.job_types.view_job_type %}
          <c-table.td href="{{ obj.job_type.get_update_path }}">
            {{ obj.job_type.name }}
          </c-table.td>
          {% else %}
          <c-table.td>{{ obj.job_type.name }}</c-table.td>
          {% endif %}

          <c-table.td>{{ obj.description }}</c-table.td>

          <td>
            {% if can_delete or can_update %}
            <c-context.context class="ltr:right-[calc(100%+4px)] rtl:left-[calc(100%+4px)] bottom-2 min-w-[100px]">

              {% if can_delete %}
                <c-context.btn
                    hx-get="{{ obj.get_delete_path }}"
                    hx-vals="js:{page: '{{ page_obj.number }}'}"
                    hx-target="#modal"
                    @click="modalOpen = true">
                    {% translate 'delete' %}
                </c-context.btn>
              {% endif %}

              {% if can_update %}
                <c-context.btn href="{{ obj.get_update_path }}" datatype="href">
                    {% translate 'update' %}
                </c-context.btn>
              {% endif %}

            </c-context.context>
            {% endif %}
          </td>
        </c-table.tr>
        {% empty %}
        <c-table.empty-tr colspan="5" />
        {% endfor %}
      </c-table.tbody>
      <!-- end rows -->
    </c-table.table>

  </c-table.container>

</form>